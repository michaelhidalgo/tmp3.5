<?xml version="1.0" encoding="utf-8"?>
<TeamMentor_Article Metadata_Hash="-857745980" Content_Hash="-1410527183">
  <Metadata>
    <Id>660cb349-fe70-4693-921a-20cc5def9e76</Id>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>リダイレクトと転送の宛先を検証する</Title>
    <Category>入力とデータの検証</Category>
    <Phase>実装</Phase>
    <Technology>Web アプリケーション</Technology>
    <Type>チェックリスト項目</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>適用対象</h1>
  <ul>
    <li>Web アプリケーション</li>
  </ul>
  <h1>チェック対象</h1>
  <p>リダイレクトと転送の宛先が検証されていることを確認します。</p>
  <h1>理由</h1>
  <p>リダイレクトと転送の宛先が検証されていない場合、攻撃者は、正当なサイトを示しているように見えるが、実際には攻撃者が管理している悪意のあるページを示しているハイパーリンクを作成することがあります。 この手法はしばしば、フィッシング詐欺で利用され、人をだまして偽のサイトに誘い込み、Credential 情報を盗みます。 また、宛先が検証されていない場合、リダイレクトまたは転送のパラメータが操作されて、無許可のアクセス権が取得されてしまうことがあります。</p>
  <h1>チェック方法</h1>
  <p>次の手順を使用して、リダイレクトと転送の宛先が検証されていることを確認します。</p>
  <ol>
    <li>
      <p>
        <strong>リダイレクトと転送を特定します。</strong> コードをレビューして、リダイレクトと転送をすべて見つけます。</p>
      <li>
        <p>
          <strong>宛先を列挙します。</strong> リダイレクトと転送ごとにすべての宛先のリストを作成します。</p>
        <li>
          <p>
            <strong>アクセス許可を特定します。</strong> ユーザー ロールごとに、各宛先へのアクセスを許可する状況を判別します。</p>
          <li>
            <p>
              <strong>リダイレクトと転送を調べます</strong> 宛先を判別するために、完全修飾 URL ではなくマッピング値がリダイレクトと転送で使用されていることを確認します。 各リダイレクトと転送のコードをレビューし、ユーザーに認可されたリソースのみにユーザーがアクセスできることを保証するために、すべての宛先が検証されていることを確認してください。 </p>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>修正方法</h1>
  <p>次のアクションを実行して、リダイレクトと転送が検証されるようにします。</p>
  <ol>
    <li>
      <p>
        <strong>リダイレクトと転送を特定します。</strong> コードをレビューして、リダイレクトと転送をすべて見つけます。</p>
      <li>
        <p>
          <strong>宛先をマッピングします。</strong> リダイレクトと転送ごとにすべての宛先のリストを作成します。 リダイレクトと転送で使用されるすべての宛先にマッピング値を定義します。 マッピング値は、リソースを象徴的に表している、識別用の短い文字列です。</p>
        <li>
          <p>
            <strong>アクセス許可を定義します。</strong> ユーザー ロールごとに、各宛先へのアクセスを許可する状況を判別します。</p>
          <li>
            <p>
              <strong>リダイレクトを検証します。</strong> 入力としてマッピング値を使用して、リダイレクトまたは転送の最終的な宛先を計算するようにリダイレクトと転送を書き換えます。 リダイレクトまたは転送の宛先であるリソースへのアクセス許可をユーザーが持っていることを検証する検証ルーチンを追加します。</p>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>その他のリソース</h1>
  <ul>
    <li>リダイレクトまたはフォワードの無効化に関する詳細は、次を参照してください。<a href="http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards">http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards</a></li>
  </ul>
  <h1>関連する項目</h1>
  <ul>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>