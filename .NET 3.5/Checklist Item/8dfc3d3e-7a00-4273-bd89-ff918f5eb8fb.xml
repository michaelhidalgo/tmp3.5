<?xml version="1.0" encoding="utf-8"?>
<TeamMentor_Article Metadata_Hash="-817117151" Content_Hash="-704939626">
  <Metadata>
    <Id>8dfc3d3e-7a00-4273-bd89-ff918f5eb8fb</Id>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>重要なセキュリティ業務をログに記録する</Title>
    <Category>監査とログ記録</Category>
    <Phase>設計</Phase>
    <Technology>ASP.NET 3.5</Technology>
    <Type>チェックリスト項目</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>チェック対象</h1>
  <p>アプリケーションがアプリケーションのセキュリティレベルに関連したすべての重要な操作をログ記録するか確認してください。 そのような操作には、認証の試行、ユーザー アカウントの変更、新しいアカウントのアクティブ化などがあります。 </p>
  <h1>理由</h1>
  <p>ログでセキュリティ操作を追跡することで、アプリケーションの誤使用や悪意のあるアクティビティを把握できます。 また、操作を追跡しておくようにすると、被害を評価して今後保護を強化するのに役立ちます。</p>
  <h1>チェック方法</h1>
  <p>以下の手順によって、アプリケーションが重要なセキュリティの操作をログ記録するか確認してください｡</p>
  <ol>
    <li>
      <p>
        <strong>アプリケーションが実行する重要な操作を列挙してください｡ </strong>アプリケーションのアーキテクチャとセキュリティの目的を確認して、ログに記録する重要な操作が何かを判断します。 一般に、システムへの悪意のある攻撃を認識または追跡するのに役立つものはすべてログ記録しなければなりません。 以下のような内容が含まれます。</p>
      <ul>
        <li>
          <strong>認証試行:</strong> アプリケーションが、成否にかかわらずすべての認証試行をログ記録することを確認します。 リモートホストのIPまたは名前のような追加情報を含めることも選択できます。 認証の試みをログ記録することにより、いつアカウントが危険にさらされた、またはアプリケーションが悪意のある活動に使用されたときの記録が残ります｡ <li><strong>アカウントの変更:</strong> アプリケーションが、 ユーザーのアカウントに加えられたすべての変更をログ記録することを確認します。 そのような変更には、パスワード/PIN、アカウント詳細、および連絡先情報がそれらに限定されず含まれます｡ このようなログは、セキュリティの侵害による被害を追跡する場合や、ロックアウト ポリシーを強制する場合に役立ちます。 <li><strong>ログインしたユーザーが実行するトランザクション:</strong> アプリケーションがログインしたユーザーによって実行された、なんらかの値を有するすべてのトランザクションをログ記録することを確認します。 たとえば、e コマースによる購入は金銭の値が含まれるため、ログに記録するようにします。 また、機微データが含まれるユーザー トランザクションもログに記録することをお勧めします。 ただし、実際の機微データはログ記録しないでください。 <li><strong>アカウントの作成、アクティブ化、ロックおよびロック解除: </strong>ユーザーの作成、アクティブ化、およびロックアウトに関するすべての操作をアプリケーションがログ記録するか確認してください｡ ログ記録された情報は、リモートIPおよび有効なEメールアドレスを含まれなければなりません。 これらのログは、被害を受けたアカウントおよび正当でないユーザーを調査する際に役に立つ場合があります。 <li><strong>システムおよびセキュリティ関連の管理操作:</strong> アプリケーションがアプリケーションの全体的なウェルネスに関してすべてのイベントをログ記録することを確認します。 それらの実例としては、アプリケーションの構成、始動、終了、監査イベントなどがあります。</li></li></li></li></li>
      </ul>
      <li>
        <p>
          <strong>ログ記録のメカニズムを識別してください｡ </strong>ログ記録メカニズムを決定することは、どんな情報がどこに記録されているかを理解していることを保証します。 可能ならばいつでも、ASP.NETヘルス モニタリングをログ記録に使用しなければなりません。 ヘルス モニタリングを使用するコードには、<strong>System.Web.Management.WebEventProvider</strong> から継承する1 つ以上のイベント プロバイダー（生成されたログ データのシンク）、および<strong>System.Web.Management.WebAuditEvent</strong> から継承する 1 つ以上のイベント (ログ データをキャプチャするクラス) への参照が含まれます。特別なログ生成メカニズムを使用する場合､それがすべての適切な時点で呼び出され、またすべての生成されたログメッセージが実施にログとして保存されるのか、すべてのコードを手動で追跡して確認する必要があります。</p>
        <li>
          <p>
            <strong>アプリケーションのログを監査してください。 </strong>手順1により識別された重要な操作から生成されたログメッセージの中身を監査してください｡ 監査するログが利用できない場合､アプリケーションを使用して重要な操作を実行するアプリケーションコンポーネントがログ記録したサンプルデータを生成してください｡ ログ監査中に､以下を確認してください:</p>
          <ul>
            <li>
              <strong>個別のアクティビティについて正しいログ記録レベルが使用されていること。</strong> ログメッセージに不適切な重要度を割り当てた場合は、悪意のある活動を見過ごしてしまう可能性があります。 <li><strong>成功したイベントと失敗したイベントの両方がログ記録されていること</strong>。高い特権を追加できるということは、攻撃者がシステムへのアクセスを獲得できる可能性があることを暗に意味します｡ それらのイベントをログ記録しない場合は、深刻なダメージを受ける可能性があります。 </li></li>
          </ul>
        </li>
      </li>
    </li>
  </ol>
  <h1>問題の例</h1>
  <p>電子商取引サイトは、1 時間に何百ものトランザクションを行いますが、基本的なウェブ およびデータベースのログしか持っていません。 攻撃者がアプリケーションのセキュリティ実装になにか欠陥を発見した場合､すべてのセキュリティのイベントが特にログ記録されるわけではないので、他のサイトの全トラフィックのノイズに紛れてしまいます。 財政状態が急激に落ち込むまでその攻撃に気づかず、気づいたときには、重要なデータがシステムによってログ記録されておらず、存在する情報をシステムのビジネスレベルのビューに相関させる方法がないという事実により、調査や問題解決が困難になります。</p>
  <h1>関連ガイドライン</h1>
  <ul>
    <li>
      <a href="/article/a053c4e4-2aad-41b9-b60b-e0fdeffd39f4">ガイドライン: 重要なセキュリティ操作をログ記録する</a>
    </li>
  </ul>
  <hr />
  <p>出典: Microsoft Patterns &amp; Practices ガイダンス </p>]]></Data>
  </Content>
</TeamMentor_Article>