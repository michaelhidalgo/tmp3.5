<?xml version="1.0" encoding="utf-8"?>
<TeamMentor_Article Metadata_Hash="1520618271" Content_Hash="790732975">
  <Metadata>
    <Id>0def44d6-fea1-45a9-951c-79b54d549e5c</Id>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>監査およびログ ファイルへのアクセスを制約する</Title>
    <Category>監査とログ記録</Category>
    <Phase>実装</Phase>
    <Technology>ASP.NET 3.5</Technology>
    <Type>ガイドライン</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>行うべき事柄</h1>
  <p>監査およびログ ファイルへのアクセスを制約してください。&nbsp; アプリケーション アカウントは書き込み専用アクセス権を持つ必要があり、オペレーターとサポート担当者は必要に応じて読み取り専用アクセス権を持つべきです。&nbsp; 管理者のアカウントは、完全なアクセスを持つべき唯一のアカウントですが、一部のケースではこれさえも制約または回避されることが推奨されます。 </p>
  <h1>理由</h1>
  <p>ログ ファイルへのアクセスを制限すると、攻撃者が痕跡を隠すためにログ ファイルを改ざんすることが困難になります。&nbsp; さらに、アクションの否認や偽造の機会が少なくなります。 </p>
  <h1>状況</h1>
  <p>ログ ファイルへのアクセスは、ログ記録方法またはシステム アーキテクチャに関わらず、常に制約することをお勧めします。&nbsp; 可能で望ましい保護の程度は、システム アーキテクチャの詳細およびアプリケーションのセキュリティ要件に依存しますが、何らかのレベルの保護を行うことは常に適切です。 </p>
  <h1>対策</h1>
  <p>ログ記録には通常 2 つの方法があります。ファイルに記録するか、SQL Server に記録するかのどちらかです。&nbsp; アクセスを保護するそれぞれの方法を以下に示します。</p>
  <ul>
    <li>
      <p>
        <strong>ファイルへのログ記録。 </strong>Windows ACL を使用して監査ファイルとログ ファイルを保護し、ログ ファイルへのアクセスを制限します。 ログ ファイルに適切なアクセス許可を割り当てます。 ログ記録の書き込みは、書き込みの権限のみを持つプロセスによって行われる必要があります。 ログは、アクセスを必要とするオペレーターおよびサポート人員に対しては、読み取り専用であるべきです。 管理者のみが完全なアクセスを持つことをお勧めします。 ログ ファイルを操作できる個人の数を最小限に抑えてください。&nbsp; 管理者のような高い信頼を得ているアカウントに対してのみ、アクセス権を承認してください。 </p>
      <li>
        <p>
          <strong>SQL Server へのログ記録。</strong> SQL Server またはカスタム イベント シンクにイベントをログ記録する場合は、イベント データへのアクセスを制限するために適切なアクセス制御を使用してください。 アプリケーションを使用するアカウントに書き込みアクセスを付与してください。 管理者に完全な制御権を付与してください。 オペレーターに読み取り専用アクセス権を付与する ログ ファイルを操作できる個人の数を最小限に抑えてください。&nbsp; 管理者のような高い信頼を得ているアカウントに対してのみ、アクセス権を承認してください。</p>
      </li>
    </li>
  </ul>
  <h1>問題の例</h1>
  <p>オンライン銀行は、トランザクション ログのすべてをデータベースに、また Web ログをフラット ファイルに保管します。&nbsp; フラット ファイルのアクセス許可は、すべてのユーザーによる書き込みが可能であり、データベースのアクセス許可は、すべてのサポート人員に完全な編集制御権が付与されています。&nbsp; 攻撃者は、ウェブ サーバを攻撃しますが、相対的に低い特権のアプリケーション アカウントにより制約されています。&nbsp; しかし、それでもサーバ上で検出されずに残っている Web ログから、攻撃のすべての痕跡を削除することが出来ます。&nbsp; サポート アカウントのパスワードをクラックできた時、Web のフロント エンドから強制的にトランザクションの記録を削除することができ、その結果、銀行は著しい損失をこうむります。</p>
  <h1>ソリューションの例</h1>
  <p>オンライン銀行は、トランザクション ログのすべてをデータベースに、また Web ログをフラット ファイルに保管します。&nbsp; フラット ファイルでのアクセス許可は、アプリケーション アカウントに書き込み専用アクセスを、サポートスタッフに読み取り専用アクセスを、管理者にのみ完全な制御権を付与します。&nbsp; データベースでのアクセス許可は、アプリケーション アカウントには挿入だけを、サポートスタッフには選択のみを可能にさせます。&nbsp; 攻撃者が Web サーバを攻撃する時、Web ログにある攻撃の証拠を消去することで痕跡を隠そうとすることはできません。&nbsp; それにもかかわらず、彼らはサポート アカウントのパスワードをクラックして、システムでトランザクションを強行しようと試みます。&nbsp; トランザクション ログは改変できないので、攻撃者はトランザクションが成功する前に、即座に捕まります。</p>
  <hr />
  <p>出典: Microsoft patterns & practices guidance </p>]]></Data>
  </Content>
</TeamMentor_Article>