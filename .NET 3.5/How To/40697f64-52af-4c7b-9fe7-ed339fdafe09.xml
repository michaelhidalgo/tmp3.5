<?xml version="1.0" encoding="utf-8"?>
<TeamMentor_Article Metadata_Hash="-1746833850" Content_Hash="913445577">
  <Metadata>
    <Id>40697f64-52af-4c7b-9fe7-ed339fdafe09</Id>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>選択プレーンテキストバグのテスト方法</Title>
    <Category>暗号化</Category>
    <Phase>テスト</Phase>
    <Technology>Web アプリケーション</Technology>
    <Type>その方法</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority />
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>適用対象</h1>
  <ul>
    <li>公開鍵と私有鍵の暗号化アルゴリズム</li>
  </ul>
  <h1>概要</h1>
  <p>暗号システムを攻撃する際、攻撃者の理想目的は暗号鍵を復元、または特定の暗号化された情報を解読することです。&nbsp;理想的なケースで、リモートの攻撃者ができることは暗号化パケットをスニッフィングすることのみです。 攻撃者は暗号化前のテキスト (プレーンテキスト) または暗号化後のテキスト (暗号文) のどちらも操作できません。&nbsp;選択プレーンテキスト バグは、攻撃者が任意のプレーンテキストを特に選択することを可能にします。 攻撃者は、被害者が自分のプレーンテキスト (<i>P</i>) を暗号化するように騙し、結果の暗号文 (<i>C</i>) から有用な情報を取得します。&nbsp; &nbsp;&nbsp;</p>
  <p>選択プレーンテキスト バグをテストするには、次の手順が推奨されます。</p>
  <ul>
    <li>ステップ 1: 攻撃のシナリオを理解する
<li>ステップ 2: 根本的な原因と対応策を分析する
<li>ステップ 3: テストおよび調査を開始する
<li>ステップ 4: テスト ケースを調整する</li></li></li></li>
  </ul>
  <h1>ステップ 1: 攻撃のシナリオを理解する</h1>
  <p>最初に、選択平文攻撃の詳細を理解する必要があります。 選択平文攻撃の基本概念は単純です。 攻撃者は解読する暗号化アルゴリズムに入力する<i>プレーンテキスト</i>を選択します。&nbsp;このバグの種類には 2 つのシナリオが関連しています。</p>
  <ul>
    <li>シナリオ 1:&nbsp;バッチまたはオフライン選択平文攻撃 
<li>シナリオ 2:&nbsp;適応的またはオンライン選択平文攻撃 </li></li>
  </ul>
  <h2>シナリオ 1:&nbsp;バッチまたはオフライン選択平文攻撃 </h2>
  <p>バッチのシナリオでは、攻撃者はすべてのプレーンテキストを事前 (攻撃を開始して暗号文を取得する前) に所有しています。&nbsp;攻撃者は次にプレーンテキストを問題の暗号化システムで暗号化し、ようやく対応する暗号文が取得されます。&nbsp;この攻撃は一般的に、暗号化システムの私有鍵のブルート フォースを試行するために使用されます。&nbsp;</p>
  <h2>シナリオ 2:&nbsp;適応的またはオンライン選択平文攻撃</h2>
  <p>オンライン選択平文攻撃では、攻撃者は 1 つ以上のプレーンテキスト ブロックとそれに対応する暗号文を読み込むことで開始します。&nbsp;攻撃者は次に、以前にスニッフィングされたパケットからの情報に基づいて、プレーンテキスト ブロックを生成します。&nbsp;攻撃者はその後に、被害者が新しいプレーンテキスト ブロックを暗号化するように強制します。 最後に、攻撃者は選択プレーンテキスト ブロックによって生成された暗号文を読み込みます。&nbsp;この攻撃の一般的な用途は、パスワードやクレジット カード番号のような機微な情報の盗み取りです。&nbsp; </p>
  <p>たとえば、攻撃者がクライアントとサーバー間の暗号化ネットワーク トラフィックの監視を開始するとします。 いくらかの解析後、攻撃者はクライアント パスワードがパケットの特定オフセットで送信されていることに気付きます (<i>C</i>)。 攻撃者は暗号化パスワード (<i>C</i>) を生成したプレーンテキスト <i>P</i> が他の選択プレーンテキスト <i>P' と同じかどうかを知ることを希望しています。</i><i>.</i> システムが選択プレーンテキストの脆弱性による影響を受けている場合、攻撃者はさまざまなプレーンテキスト <i>Pk';を生成し、</i> 被害者がそれらを後続の送信 (攻撃者はそれらもスニッフィングします) で使用することを強制します。&nbsp; 各プレーンテキスト <i>Pk'; に対し、</i> 攻撃者は暗号文 <i>Ck' が</i>  <i>C.&nbsp;</i> と<i>同じ</i>であることを確認します。同じである場合は選択プレーンテキスト <i>Pk' は </i>クライアントのパスワードに等しいです。 </p>
  <p>
    <i>C = E(K, P)&nbsp;&nbsp;&nbsp;&nbsp; </i>
  </p>
  <p>
    <i>Ck'; = E(K, Pk';)</i>
  </p>
  <p><i>Ck'; </i><i>˜ C </i><i> </i> の場合、<i>Pk';= P。</i></p>
  <p>攻撃に成功した場合、攻撃者は <i>Pk'; を制御し、</i>  <i>C</i> と <i>Ck';. の両方を読み込むことができます。 </i>上記の不明な値は暗号鍵(<i>K</i>) クライアントのパスワード (<i>P</i>) です。<i>&nbsp;&nbsp;</i>&nbsp;</p>
  <p>暗号化システムには、1 つ以上の暗号ブロックの暗号化を可能にする<i>ブロック暗号モード</i>が必要です。&nbsp; <i>Ck'; の暗号文は </i><i>C</i> と<i>同等 </i>であると言います。それは <i>Ck'; </i>が別のブロック (後で送信される) で存在し、暗号モードの変換を遂げるからです。&nbsp; それにも関わらず、攻撃者がこの同等性を推測した場合、<i>Pk'; の予測されたパスワードをどれかが</i> 有効であることを確認できます。&nbsp;セキュアでない暗号モードを使用するシステム (ECB など) または不十分に実装されているシステム (すなわち、推測可能な初期化ベクトルまたは <i>IV</i> を使用するシステム) は、この攻撃のバリアントにさらされます。&nbsp; </p>
  <h1>手順 2: 根本原因と緩和手段の解析</h1>
  <p>次の手順は、選択プレーンテキストの脆弱性の要因、およびそれを防止する方法を解析することです。&nbsp; セキュリティ脆弱性の根本原因を知ることは、設計と実装 (ソース コード) の両方においてそれらを特定することを助けます。&nbsp;&nbsp; </p>
  <h2>根本原因</h2>
  <p><i>被害者が暗号化するプレーンテキストを攻撃者が制御することに至る</i><i></i>設計、実装、構成、または配備の条件は、選択プレーンテキスト バグの根本原因です。</p>
  <p>ただし、この脆弱性の実際の根本原因を正確に特定することは困難です。&nbsp; Alice が Bob に暗号化されたメッセージを送信するという暗号方式のシナリオを思い浮かべてください。&nbsp; Alice は Bob にメッセージを送信する前に、自分のコンピュータでそれを暗号化します。&nbsp; 暗号化通信を監視している傍受者は、プレーンテキストを変更できません。 プレーンテキストは、暗号化と送信の前で、Alice のコンピュータのみで存在するからです。&nbsp; </p>
  <p>選択平文攻撃を実行するには、攻撃者は被害者のマシンに何らかの方法で侵入するか、攻撃者が選んだプレーンテキストをリモートで被害者が選択するように強制する必要があります。&nbsp; 被害者が攻撃者のプレーンテキストを暗号化する状況が、この脆弱性の根本原因です。&nbsp; ここでの課題は、これらの状況は暗号化システムの責任外になる可能性があるということです。&nbsp; たとえば、攻撃者がトロイの木馬を Alice のコンピュータにインストールし、後でそれが Alice のプレーンテキストが暗号化される前に置換するために使用される可能性があります。&nbsp; プレーンテキストが攻撃者の選択したものと置換された場合、生じる暗号文は暗号化後の選択プレーンテキストです。&nbsp; ここでの根本原因は、被害者が以前に攻撃者がトロイの木馬のプログラムをインストールすることを許したことであり、暗号化システム自体の欠陥ではありません。</p>
  <h2>緩和手段</h2>
  <p>この攻撃に対する緩和手段は複数ありますが、 どれも完全なソリューションではありません。&nbsp; この脆弱性をエクスプロイトするには、攻撃者はスパイウェアをインストールしたり、リモートでの被害者のファイル システムを破損させたり、被害者が攻撃者のプレーンテキストを暗号化されたメッセージの一部として付加するように強制したりするなど、さまざまな手段から選択する必要があります。&nbsp; そのため、可能な緩和手法には、最新のマルウェア保護を実行すること、オペレーティング システムを強化すること、および暗号化されたメッセージに無名テキストを含めないことなどが含まれます。&nbsp; これは多くの緩和手法があることを強調し、全体的な危険を最小化するために、多層防御のアプローチを取る必要があります。</p>
  <h1>ステップ 3: テストおよび調査を開始する</h1>
  <p>これで選択平文攻撃のシナリオ、それらの要因、およびそれらの防止方法について学んだ上で、セキュアおよびセキュアでない実装のテストを実行する必要があります。</p>
  <p>
    <b>
      <i>
      </i>
    </b>
  </p>
  <h2>オフライン選択平文攻撃に対するテスト</h2>
  <ol>
    <li>被害者を選択します。 
<li>暗号化するプレーンテキストのブロックを生成します。 
<li>被害者が手順 2 で生成されたプレーンテキストのブロックを暗号化するように強制します。 
<li>選択したプレーンテキストに対する結果の暗号文を収集します。</li></li></li></li>
  </ol>
  <p>予期される結果:生成されたプレーンテキスト ブロックを被害者に暗号化させることができない場合、テストが成功します (手順 3)。&nbsp; 手順 3 と 4 が実行可能な場合、失敗します。&nbsp;</p>
  <h2>オンライン選択平文攻撃に対するテスト</h2>
  <ol>
    <li>被害者クライアントを選択します。 
<li>被害者サーバーを選択します。 
<li>クライアントとサーバー間のネットワーク トラフィックのスニッフィングを開始します。 
<li>サーバーとクライアント間のメッセージをいくつか読み込みます。 
<li>読み込まれたメッセージの情報を使用して、サーバーまたはクライアントに暗号化および送信を強制するプレーンテキストを生成します。 
<li>被害者サーバー/クライアントが手順 5 からの選択プレーンテキストを暗号化するように強制します。 
<li>手順 5 の選択プレーンテキストに対する結果の暗号文が表示されるまで、ネットワーク トラフィックのスニッフィングを続けます。</li></li></li></li></li></li></li>
  </ol>
  <p>予期される結果:サーバーに選択プレーンテキストを暗号化させることができない場合、テストが成功します (手順 6)。&nbsp; 手順 6 と 7 が実行可能な場合、失敗します。</p>
  <p>これらの 2 つの高レベル ケースは、選択平文攻撃に対するテスト方法の基本的な詳細を描写します。&nbsp; 暗号化システムをテストする際は、必ず両方のケースに取り組んでください。&nbsp; この手順では、テスト ケースの検証方法を調査する必要があります。&nbsp; 選択プレーンテキストが実際に暗号化されていることを確認する方法、および選択プレーンテキストとそれが暗号化されたものに相当するものに一致させる方法を見つける必要があります。&nbsp; これは、ターゲット クライアントとサーバー間で使用されるプロトコルに加えて、試行錯誤について学習することを必要とします。</p>
  <h1>ステップ 4: テスト ケースを調整する</h1>
  <p>これで選択プレーンテキスト バグに対する基本的なテストについて学習したので、次は攻撃されているシステムによって、テストの詳細と影響をさらに修正する必要があります。</p>
  <h3>攻撃手段</h3>
  <p>選択平文攻撃には、基本的な要件があります。 <i>攻撃者は、被害者が選択プレーンテキストを暗号化するように騙す必要があります。&nbsp; </i></p>
  <p>適用された選択プレーンテキスト テストの攻撃手段の良い例が SSL 選択プレーンテキストの脆弱性とともに示されました。 &nbsp;また、上記の例も示されました。&nbsp; このリストは、試行する必要のある優れた攻撃手段の集まりです。</p>
  <ul>
    <li>被害者によって暗号化される前に選択プレーンテキストを変更するスパイウェアまたはトロイの木馬を被害者のシステムにインストールすること。 
<li>選択プレーンテキストをターゲットに送信し、被害者が返答でそれを暗号化するかを試行すること。 
<li>後で被害者によって暗号化される選択プレーンテキストをデータ ストアに保存すること。 
<li>プラグインのインストールの一部として選択プレーンテキストを送信すること。 
<li>暗号化 API をハイジャックして、選択プレーンテキストで (ただし、被害者のコンテキスト (被害者へのなりすまし) で)、試験者のコンソールから暗号化機能を実行すること。 
<li>被害者のコンテキストで暗号化手順を呼び出す任意のコードを被害者のコンテキストで実行すること。 </li></li></li></li></li></li>
  </ul>
  <p>このように、選択プレーンテキスト バグをテストするには、多くの手段があります。 また、さらなるエクスプロイトはインターネットで頻繁に出現します。&nbsp; この部類のバグに対してテストする際は、これらの手段に取り組み、最新の攻撃手段と技法についていくことが重要です。</p>
  <p />
  <h3>攻撃方法</h3>
  <p>選択プレーンテキストのバグをエクスプロイトすることで、2 つの攻撃方法を実行することが可能であることが見られます。</p>
  <p>
    <b>
      <i>暗号化の解読</i>
    </b>
  </p>
  <p>最初に見られる方法は、使用中の暗号化アルゴリズムの暗号鍵を復元する方法です。&nbsp; 一般的な暗号方式において、強力な鍵の長さでは合理的な期間に解読されないはずなので、暗号化と復号のルーチンは知れ渡っています。&nbsp; ただし、時として暗号化されたシステムは、56 ビットの鍵と DES のような廃れたアルゴリズムの組み合わせなどの不十分な鍵サイズを使用します。&nbsp; 適切な暗号解析を使用し、暗号化アルゴリズムを解読して鍵を復元する方法はさまざまあり、攻撃者がプレーンテキストを支配している場合、このプロセスがより簡単になることがあります。</p>
  <p>
    <b>
      <i>機微データの盗み取り</i>
    </b>
  </p>
  <p>2 つ目のシナリオでは、選択プレーンテキスト バグの使用による被害者のパスワードへの情報漏えい攻撃を実行する方法が示されました。&nbsp; このペイロードを実行するとき、攻撃者は暗号鍵の計算を試行していません。&nbsp; 攻撃者の目的は、不明なプレーンテキスト (ユーザーのパスワード) を暴露することです。攻撃者は不明なプレーンテキストによって 生成される暗号文にアクセスできます。&nbsp; さらに、選択プレーンテキスト バグが存在する場合、攻撃者は今後のプレーンテキスト、つまり結果の暗号文を支配します。&nbsp; 攻撃者は暗号化システムに送信するプレーンテキストのうち 1 つが元のプレーンテキストに等しいことを願いつつ、それらを生成します。 次に、攻撃者は生成された暗号文を基の暗号文と比較して、プレーンテキストが発見されたかどうかを確認します。&nbsp;&nbsp;</p>
  <p>両方同時のテストを試行するのではなく、必ず1 つずつの攻撃方法をテストすることに集中してください。</p>
  <h1>&nbsp;</h1>
  <h1>結論</h1>
  <p>選択平文攻撃は暗号化システムで良く起こり、さまざまな潜在的な影響があります。&nbsp; 攻撃者はこの部類の攻撃を使用してシステムの私有暗号鍵を計算するか、またはパスワードやクレジット カード番号のような秘密のプレーンテキストの発見を試行します。&nbsp; この部類の攻撃の基本的な攻撃シナリオ、それらが発生する原因、および防止方法について理解する必要があります。&nbsp; 次に、さまざまな攻撃手段を通してアプリケーションをテストして、システムの脆弱性を明らかにします。&nbsp; ここで示されるさまざまな攻撃方法でテスト ケースを調整することで終了します。</p>
  <div>
    <hr />
  </div>
  <p>[i] <b>選択平文攻撃に対する SSL の脆弱性</b>。<b>&nbsp; </b>Gregory V. Bard。&nbsp; 2004 年 5 月。&nbsp; <a href="http://citeseer.ist.psu.edu/cache/papers/cs/30519/http:zSzzSzeprint.iacr.orgzSz2004zSz111.pdf/bard04vulnerability.pdf">http://citeseer.ist.psu.edu/cache/papers/cs/30519/http:zSzzSzeprint.iacr.orgzSz2004zSz111.pdf/bard04vulnerability.pdf</a></p>
  <p>[ii] <strong>暗号解析</strong>。Wikipedia &nbsp;<a href="http://en.wikipedia.org/wiki/Cryptanalysis">http://en.wikipedia.org/wiki/Cryptanalysis</a></p>
  <div>
  </div>
  <ul>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>