<?xml version="1.0" encoding="utf-8"?>
<TeamMentor_Article Metadata_Hash="-2074554972" Content_Hash="-690686031">
  <Metadata>
    <Id>32c35abe-a470-4a9c-8bb6-54c1461d3295</Id>
    <Library_Id>92718d53-36b2-47bc-b6f5-e60994385f46</Library_Id>
    <Title>URL リダイレクション攻撃</Title>
    <Category>セッション管理</Category>
    <Phase>実装</Phase>
    <Technology> 任意</Technology>
    <Type>攻撃</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
    <Source>SI</Source>
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>適用先</h1>
  <ul>
    <li>Web アプリケーション</li>
  </ul>
  <h1>説明</h1>
  <p>多くの Web アプリケーションは、ユーザーを別のサイトや同じサイトの別のページに移動させるための機能として、URL リダイレクションを使用しています。 攻撃者は、この脆弱性を利用して、ユーザーに、信頼済みの Web サイト内を移動していると思わせて、機密情報を悪意のある Web サイトに入力させられる場合があります。</p>
  <h1>影響</h1>
  <ul>
    <li>
      <strong>Web サイト フォージェリ</strong>: 攻撃者が、ユーザーを信頼済みのサイトから別のサイトにリダイレクトできた場合、被害者はリダイレクションに気づかず、悪意のある Web サイトを信頼する恐れがあります。</li>
  </ul>
  <h1>脆弱性</h1>
  <ul>
    <li>リダイレクションの不適切な使用。 <li>リダイレクションを行うときにユーザーに適切なアラートを知らせないこと。</li></li>
  </ul>
  <h1>対策</h1>
  <ul>
    <li>ホスト名が固定であっても、決してユーザー指定の URLへ通知なしでリダイレクトを行うことを許可しないでください。</li>
  </ul>
  <h1>例</h1>
  <p>Web アプリケーションのログイン ページには、フル クエリの文字列により、ログイン後にユーザーを指定されたページ内へリダイレクトする機能があります。 これは、ユーザーが読み込もうとしたページに関する情報を失わずに、アクセスの前にユーザーにログインするようにページが求めることを許可するために使用されます。 都合の悪いことに、このアプリケーションには、アプリケーションの状態が 1 つの get リクエストで変化するページもあります。 これらを組み合わせると、攻撃者は正当なログインページでユーザーの認証資格を尋ねた後、気づかれないようにして、そのユーザーとして何らかのアクションを実行するような、1 つの URL を作り出すことができるようになります。 この問題を修正するには、リダイレクトのリンクに対し、何らかの方法でアプリケーションによる署名を行って、反復を防止し、この機能を正当な方法でのみ使用できるようにするべきです。 加えて、攻撃者がリンクに細工をして、正当なサイトの一部であるように見せかけるのを防ぐため、リダイレクト文字列は POST 変数として渡されるべきです。</p>
  <p>もう1つの例として、ページにはユーティリティ機能があり、開発者は、それとはわからない方法で他のサイトにリダイレクトすることができます。 この方法で、フィッシング グループは、アプリケーション サイト上に一見正当に見える URL を構築し、わからないうちに悪意のあるサイトにリダイレクトするようにできます。 彼らはこの URL を、疑いを持っていないユーザーに渡します。ユーザーは、正当なサイトにアクセスしていると信じていますが、実際にはだまされて悪意のあるサイトにアクセスしています。</p>
  <h1>その他のリソース</h1>
  <p>
    <a href="http://seclists.org/webappsec/2006/q1/0066.html">http://seclists.org/webappsec/2006/q1/0066.html</a>
  </p>
  <p>
    <a href="http://www.pc-help.org/obscure.htm">http://www.pc-help.org/obscure.htm</a>
  </p>
  <h1>関連する項目</h1>
  <ul>
  </ul>]]></Data>
  </Content>
</TeamMentor_Article>